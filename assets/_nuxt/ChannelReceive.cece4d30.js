import B from"./InputNumber.05cf9b73.js";import{u as E}from"./request.b3446890.js";import{u as Y}from"./useToastMessage.af91aa57.js";import{a as A,b as H}from"./queues_request.36fdf4e2.js";import{a as Q,b as U,v as w,f as F,y as S,H as G,o as n,h as r,i as t,m as x,u as l,j as o,A as P,a3 as C,s as y,w as c,G as K,r as q,t as p,K as O,p as j,k as z,l as $}from"./entry.61f443fa.js";import{_ as J}from"./ReceivedMessage.vue_vue_type_script_setup_true_lang.dda6ae42.js";import"./Field.vue_vue_type_script_setup_true_lang.5dd75765.js";import"./DataField.vue_vue_type_script_setup_true_lang.1c06eec1.js";const M=u=>(j("data-v-9b7d55d2"),u=u(),z(),u),W={class:"grid-nogutter grid col-12 p-0"},X={key:0,class:"col-12 md:12 border-bottom-1 border-light-grey"},Z={class:"flex align-items-end grid p-fluid col-3 pb-0 mb-1"},ee={class:"col-12 md:col-6"},te={key:1,class:"col-12 md:12 border-bottom-1 border-light-grey"},se={class:"flex align-items-end grid p-fluid col-3 pb-0 mb-1"},oe={class:"col-12 md:col-6 pt-0"},ae={key:2,class:"col-12 md:12"},le={class:"white-space-nowrap overflow-hidden text-overflow-ellipsis",style:{width:"15em"}},de={key:0,class:"white-space-nowrap overflow-hidden text-overflow-ellipsis",style:{width:"10em"}},ie={key:1},ne=M(()=>t("code",{class:"text-grey font-italic"},"N/A",-1)),re=[ne],ce={key:0,class:"white-space-nowrap overflow-hidden text-overflow-ellipsis",style:{width:"35em"}},ue={class:"text-overflow-ellipsis"},me={key:1},pe=M(()=>t("code",{class:"text-grey font-italic"},"No Body",-1)),ve=[pe],ge=Q({__name:"ChannelReceive",props:{modelValue:{type:String,default:()=>""},mode:{type:String,default:()=>"waiting"}},setup(u){const h=u,{isStreamReady:f}=U();let d=w([]);const V=E(),R=F(),m=w(!1),D=Y(),v=S("queue-channel-receive-pull-count",1),g=S("queue-channel-receive-peek-count",1024),b=w();G(()=>{d.value=[],b.value=null});const I=a=>{N(a.data.sequence)},k=()=>{m.value=!0,K(()=>{m.value=!0});let a;h.mode==="waiting"?a=new A(h.modelValue,g.value):a=new H(h.modelValue,v.value),V.sendRequest(a).then(s=>{d.value=s.data,d.value?d.value.forEach((_,i)=>{_.index=i+1}):d.value=[]}).catch(s=>{D.showError("Error getting queue messages",s)}).finally(()=>{m.value=!1})},N=a=>{R.open(J,{props:{header:"View a Queue Message",style:{width:"60vw"},breakpoints:{"960px":"75vw","640px":"90vw"},modal:!0},data:{message:d.value.find(s=>s.sequence===a)}})},L=a=>O(a).format("YYYY-MM-DD HH:mm:ss");return(a,s)=>{const _=B,i=q("Column"),T=q("DataTable");return n(),r("div",W,[u.mode==="waiting"?(n(),r("div",X,[t("div",Z,[t("div",{class:x(["col-12 md:col-6 pt-0",!l(f)||m.value?"div-disabled":""])},[o(_,{label:"Number of Messages",modelValue:l(g),"onUpdate:modelValue":s[0]||(s[0]=e=>P(g)?g.value=e:null),min:1,max:1024},null,8,["modelValue"])],2),t("div",ee,[o(l(C),{label:"Peek",class:"button-queue",onClick:k,icon:"pi pi-clock",loading:m.value,disabled:!l(f)},null,8,["loading","disabled"])])])])):y("",!0),u.mode==="pull"?(n(),r("div",te,[t("div",se,[t("div",{class:x(["col-12 md:col-6 pt-0",!l(f)||m.value?"div-disabled":""])},[o(_,{label:"Number of Messages",modelValue:l(v),"onUpdate:modelValue":s[1]||(s[1]=e=>P(v)?v.value=e:null),min:1,max:1024},null,8,["modelValue"])],2),t("div",oe,[o(l(C),{label:"Pull",class:"button-queue",onClick:k,icon:"pi pi-download",loading:m.value},null,8,["loading"])])])])):y("",!0),l(d).length>0?(n(),r("div",ae,[o(T,{value:l(d),paginator:l(d).length>25,rows:25,responsiveLayout:"scroll",class:"p-datatable-sm",dataKey:"messageId",onRowSelect:I,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Messages",selection:b.value,"onUpdate:selection":s[2]||(s[2]=e=>b.value=e),selectionMode:"single"},{empty:c(()=>[]),default:c(()=>[o(i,{header:"#",headerStyle:"width: 1em"},{body:c(({index:e})=>[t("div",null,p(e+1),1)]),_:1}),o(i,{header:"Sequence",field:"sequence",sortable:"",headerStyle:"width: 4em"},{body:c(({data:e})=>[t("div",null,p(e.sequence),1)]),_:1}),o(i,{field:"timestamp",header:"Timestamp",sortable:"",headerStyle:"width: 10em"},{body:c(({data:e})=>[t("div",null,p(L(e.timestamp)),1)]),_:1}),o(i,{header:"Message Id",field:"messageId",sortable:"",headerStyle:"width: 10em"},{body:c(({data:e})=>[t("div",le,p(e.messageId),1)]),_:1}),o(i,{header:"Metadata",field:"metadata",headerStyle:"width: 10em"},{body:c(({data:e})=>[e.metadata?(n(),r("div",de,[t("code",null,p(e.metadata),1)])):(n(),r("div",ie,re))]),_:1}),o(i,{header:"Body",field:"body",headerStyle:"width: 35em"},{body:c(({data:e})=>[e.body?(n(),r("div",ce,[t("code",ue,p(e.body),1)])):(n(),r("div",me,ve))]),_:1})]),_:1},8,["value","paginator","selection"])])):y("",!0)])}}}),xe=$(ge,[["__scopeId","data-v-9b7d55d2"]]);export{xe as default};
