import B from"./InputNumber.c78c294d.js";import{u as E}from"./request.226e26ee.js";import{u as Q}from"./useToastMessage.5053bbd0.js";import{a as Y,b as A}from"./queues_request.d6d8f046.js";import{m as U}from"./StatStripCard.vue_vue_type_style_index_0_scoped_b87ef05f_lang.52c9345e.js";import{a as F,s as b,e as H,Q as O,o as d,f as r,h as s,l as x,u as l,i as o,A as C,a2 as q,q as y,w as c,t as p,E as j,r as P,p as z,j as G,k as K}from"./entry.53b34a98.js";import{u as W,a as M}from"./stream.38699bf4.js";import{_ as $}from"./ReceivedMessage.vue_vue_type_script_setup_true_lang.8cb253f1.js";import"./Field.vue_vue_type_script_setup_true_lang.8447d9ba.js";import"./DataField.vue_vue_type_script_setup_true_lang.e7665b77.js";const R=u=>(z("data-v-8740f700"),u=u(),G(),u),J={class:"grid-nogutter grid col-12 p-0"},X={key:0,class:"col-12 md:12 border-bottom-1 border-light-grey"},Z={class:"flex align-items-end grid p-fluid col-3 pb-0 mb-1"},ee={class:"col-12 md:col-6"},se={key:1,class:"col-12 md:12 border-bottom-1 border-light-grey"},te={class:"flex align-items-end grid p-fluid col-3 pb-0 mb-1"},oe={class:"col-12 md:col-6 pt-0"},ae={key:2,class:"col-12 md:12"},le={class:"white-space-nowrap overflow-hidden text-overflow-ellipsis",style:{width:"15em"}},ne={key:0,class:"white-space-nowrap overflow-hidden text-overflow-ellipsis",style:{width:"10em"}},ie={key:1},de=R(()=>s("code",{class:"text-grey font-italic"},"N/A",-1)),re=[de],ce={key:0,class:"white-space-nowrap overflow-hidden text-overflow-ellipsis",style:{width:"35em"}},ue={class:"text-overflow-ellipsis"},me={key:1},pe=R(()=>s("code",{class:"text-grey font-italic"},"No Body",-1)),he=[pe],ve=F({__name:"ChannelReceive",props:{channel:{type:String,default:()=>""},mode:{type:String,default:()=>"waiting"}},setup(u){const _=u,{isStreamReady:f}=W();let n=b([]);const D=E(),V=H(),m=b(!1),k=Q(),h=M("queue-channel-receive-pull-count",1),v=M("queue-channel-receive-peek-count",1024),w=b();O(()=>{n.value=[],w.value=null});const I=a=>{N(a.data.sequence)},S=()=>{m.value=!0,j(()=>{m.value=!0});let a;_.mode==="waiting"?a=new Y(_.channel,v.value):a=new A(_.channel,h.value),D.sendRequest(a).then(t=>{n.value=t.data,n.value?n.value.forEach((g,i)=>{g.index=i+1}):n.value=[]}).catch(t=>{t.isCanceled?k.showWarn("Request Canceled"):k.showError("Error getting queue messages",t.messages)}).finally(()=>{m.value=!1})},N=a=>{V.open($,{props:{header:"View a Queue Message",style:{width:"60vw"},breakpoints:{"960px":"75vw","640px":"90vw"},modal:!0},data:{message:n.value.find(t=>t.sequence===a)}})},L=a=>U(a).format("YYYY-MM-DD HH:mm:ss");return(a,t)=>{const g=B,i=P("Column"),T=P("DataTable");return d(),r("div",J,[u.mode==="waiting"?(d(),r("div",X,[s("div",Z,[s("div",{class:x(["col-12 md:col-6 pt-0",!l(f)||m.value?"div-disabled":""])},[o(g,{label:"Number of Messages",modelValue:l(v),"onUpdate:modelValue":t[0]||(t[0]=e=>C(v)?v.value=e:null),min:1,max:1024},null,8,["modelValue"])],2),s("div",ee,[o(l(q),{label:"Peek",class:"button-queue",onClick:S,icon:"pi pi-clock",loading:m.value,disabled:!l(f)},null,8,["loading","disabled"])])])])):y("",!0),u.mode==="pull"?(d(),r("div",se,[s("div",te,[s("div",{class:x(["col-12 md:col-6 pt-0",!l(f)||m.value?"div-disabled":""])},[o(g,{label:"Number of Messages",modelValue:l(h),"onUpdate:modelValue":t[1]||(t[1]=e=>C(h)?h.value=e:null),min:1,max:1024},null,8,["modelValue"])],2),s("div",oe,[o(l(q),{label:"Pull",class:"button-queue",onClick:S,icon:"pi pi-download",loading:m.value},null,8,["loading"])])])])):y("",!0),l(n).length>0?(d(),r("div",ae,[o(T,{value:l(n),paginator:l(n).length>25,rows:25,responsiveLayout:"scroll",class:"p-datatable-sm",dataKey:"messageId",onRowSelect:I,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Messages",selection:w.value,"onUpdate:selection":t[2]||(t[2]=e=>w.value=e),selectionMode:"single"},{empty:c(()=>[]),default:c(()=>[o(i,{header:"#",headerStyle:"width: 1em"},{body:c(({index:e})=>[s("div",null,p(e+1),1)]),_:1}),o(i,{header:"Sequence",field:"sequence",sortable:"",headerStyle:"width: 4em"},{body:c(({data:e})=>[s("div",null,p(e.sequence),1)]),_:1}),o(i,{field:"timestamp",header:"Timestamp",sortable:"",headerStyle:"width: 10em"},{body:c(({data:e})=>[s("div",null,p(L(e.timestamp)),1)]),_:1}),o(i,{header:"Message Id",field:"messageId",sortable:"",headerStyle:"width: 10em"},{body:c(({data:e})=>[s("div",le,p(e.messageId),1)]),_:1}),o(i,{header:"Metadata",field:"metadata",headerStyle:"width: 10em"},{body:c(({data:e})=>[e.metadata?(d(),r("div",ne,[s("code",null,p(e.metadata),1)])):(d(),r("div",ie,re))]),_:1}),o(i,{header:"Body",field:"body",headerStyle:"width: 35em"},{body:c(({data:e})=>[e.body?(d(),r("div",ce,[s("code",ue,p(e.body),1)])):(d(),r("div",me,he))]),_:1})]),_:1},8,["value","paginator","selection"])])):y("",!0)])}}}),qe=K(ve,[["__scopeId","data-v-8740f700"]]);export{qe as default};
