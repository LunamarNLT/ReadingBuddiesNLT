import z from"./InputText.95e7607b.js";import H from"./InputNumber.f5d5af79.js";import W from"./CodeEditor.f3e0f57e.js";import{_ as G}from"./Field.vue_vue_type_script_setup_true_lang.a9d10359.js";import{_ as L}from"./DataField.vue_vue_type_script_setup_true_lang.6b0a27ba.js";import{u as P}from"./request.95ba5b66.js";import{u as J}from"./useToastMessage.dd22ad89.js";import{a as K,y as I,v as y,z as O,x as X,o as c,h as r,i as e,m as Z,j as l,u as o,A as M,s as v,w,B as ee,C as se,F as oe,D as le,E as te,G as ae,r as C,p as ne,k as de,H as ie,l as ue}from"./entry.ac81eb43.js";import{u as me,r as q}from"./index.esm.108bfc55.js";import{S as ce}from"./cqrs_request.99b5023f.js";class re{constructor(){this.requestId="",this.channel="",this.clientId="",this.metadata="",this.body="",this.tags="",this.isCommands=!1,this.timeout=0}}class pe{constructor(){this.metadata="",this.body="",this.tags="",this.timestamp=0,this.executed=!1,this.error=""}}const B=p=>(ne("data-v-f03fa843"),p=p(),de(),p),ve={key:0},_e={key:0,class:"flex align-items-end grid p-fluid col-12 pb-0 mb-2"},he={class:"col-12 md:col-3 pt-0"},fe={class:"col-12 md:col-3 pt-0"},ge={class:"flex"},be={class:"mr-2"},ye=B(()=>e("label",{class:"ml-1",for:"commands"},"Commands",-1)),Ce={class:"ml-2"},Se=B(()=>e("label",{class:"ml-1",for:"queries"},"Queries",-1)),Ve={class:"flex align-items-end grid p-fluid col-12 pb-0 mb-2"},qe={class:"col-12 md:col-2 pt-0"},xe={class:"flex align-items-end grid p-fluid col-12 pb-0 mb-1"},Re={class:"col-12 md:col-12 pt-0"},ke={class:"flex align-items-end grid p-fluid col-12 pb-0 mb-1 mt-2"},Ie={class:"col-12 md:col-12 pt-0"},Me={class:"flex align-items-end grid p-fluid border-top-1 border-light-grey col-12 pb-0 mb-1"},we={class:"col-12 md:col-4 pt-0"},Be={class:"col-12 md:col-4 pt-0"},Te={class:"col-12 md:col-4 pt-0"},Fe={class:"grid-nogutter grid col-12 mt-2"},Ae={class:"flex align-items-end grid justify-content-end p-fluid col-12 pb-0 mb-1 mt-2"},Qe={class:"mr-2"},Ue={class:"ml-2"},De={key:1,class:"grid formgrid p-fluid col-12 md:12 pt-3"},Ee={class:"col-12 md:col-3 p-1"},$e={class:"col-12 md:col-3 p-1"},Ne={class:"col-12 md:col-6 p-1"},Ye={key:0,class:"col-12 md:col-6 p-1"},je={key:1,class:"col-12 md:col-6 p-1"},ze={key:2,class:"col-12 md:col-12 p-1"},He=K({__name:"SendMessage",setup(p){const T=le("system-connection"),F=m=>{m==="disconnected"&&close()};T.on(F);const n=I("send-cqrs-required-Data",{channel:"",body:"",timeout:60}),i=I("send-cqrs-radio-button","commands"),d=te("dialogRef"),S=y(!1);let a=O(new re);const u=y(new pe);X(()=>{S.value=d.value.data.isChannelSource,g.value=!1,d.value.options.props.header="Send a Commands & Queries Message",S.value&&(n.value.channel=d.value.data.channel,i.value=d.value.data.isCommands?"commands":"queries",d.value.data.isCommands?d.value.options.props.header="Send a Command message to: "+n.value.channel:d.value.options.props.header="Send a Query message to: "+n.value.channel)});const A=P();let f=null;const V=J(),_=y(!1),g=y(!1),x=me({body:{required:q},channel:{required:q},timeout:{required:q}},n.value),Q=m=>{m&&(_.value=!0,ie(()=>{_.value=!0}),a.isCommands=i.value==="commands",a.channel=n.value.channel,a.body=n.value.body,a.timeout=n.value.timeout,f=new ce(a),A.sendRequest(f).then(s=>{V.showSuccess("Message Sent Successfully"),g.value=!0,d.value.options.props.header="Commands & Queries Message Response",u.value=s.data}).catch(s=>{s.isCanceled?V.showWarn("Request Canceled"):V.showWarn("Error sending Commands & Queries message",s.message)}).finally(()=>{_.value=!1}))},U=()=>{f&&f.abort(),d.value.close()},D=m=>m===0?"N/A":ae(m).format("YYYY-MM-DD HH:mm:ss");return(m,s)=>{const b=z,R=C("RadioButton"),E=H,$=W,N=C("AccordionTab"),Y=C("Accordion"),k=C("Button"),h=G,j=L;return c(),r(oe,null,[g.value?v("",!0):(c(),r("div",ve,[e("form",{onSubmit:s[9]||(s[9]=ee(t=>Q(!o(x).$invalid),["prevent"]))},[e("div",{class:Z(["grid-nogutter grid col-12 mt-2",_.value?"div-disabled":""])},[S.value?v("",!0):(c(),r("div",_e,[e("div",he,[l(b,{label:"Channel*",modelValue:o(n).channel,"onUpdate:modelValue":s[0]||(s[0]=t=>o(n).channel=t),placeholder:"Channel name"},null,8,["modelValue"])]),e("div",fe,[e("div",ge,[e("div",be,[l(R,{inputId:"commands",name:"cqrs",value:"commands",modelValue:o(i),"onUpdate:modelValue":s[1]||(s[1]=t=>M(i)?i.value=t:null)},null,8,["modelValue"]),ye]),e("div",Ce,[l(R,{inputId:"queries",name:"cqrs",value:"queries",modelValue:o(i),"onUpdate:modelValue":s[2]||(s[2]=t=>M(i)?i.value=t:null)},null,8,["modelValue"]),Se])])])])),e("div",Ve,[e("div",qe,[l(E,{label:"Timeout in Seconds",modelValue:o(n).timeout,"onUpdate:modelValue":s[3]||(s[3]=t=>o(n).timeout=t),min:1,max:82320},null,8,["modelValue"])])]),e("div",xe,[e("div",Re,[l($,{label:"Body*",modelValue:o(n).body,"onUpdate:modelValue":s[4]||(s[4]=t=>o(n).body=t),height:"300px"},null,8,["modelValue"])])]),e("div",ke,[e("div",Ie,[l(Y,null,{default:w(()=>[l(N,{header:"Message Attributes"},{default:w(()=>[e("div",Me,[e("div",we,[l(b,{label:"Request Id",modelValue:o(a).requestId,"onUpdate:modelValue":s[5]||(s[5]=t=>o(a).requestId=t),placeholder:"Request Id"},null,8,["modelValue"])]),e("div",Be,[l(b,{label:"Metadata",modelValue:o(a).metadata,"onUpdate:modelValue":s[6]||(s[6]=t=>o(a).metadata=t),placeholder:"metadata string..."},null,8,["modelValue"])]),e("div",Te,[l(b,{label:"Tags",modelValue:o(a).tags,"onUpdate:modelValue":s[7]||(s[7]=t=>o(a).tags=t),placeholder:"key=value,key2=value2"},null,8,["modelValue"])])])]),_:1})]),_:1})])])],2),e("div",Fe,[e("div",Ae,[e("div",Qe,[l(k,{label:"Cancel",class:"button-grey",icon:"pi pi-times",onClick:s[8]||(s[8]=t=>U()),style:{width:"10rem"}})]),e("div",Ue,[l(k,{label:"Send",type:"submit",disabled:o(x).$invalid,class:"button-grey",loading:_.value,icon:"pi pi-send",style:{width:"10rem"}},null,8,["disabled","loading"])])])])],32)])),g.value?(c(),r("div",De,[e("div",{class:"grid formgrid p-fluid col-12 md:12",style:se(o(a).isCommands?"height: 15vh":"")},[e("div",Ee,[l(h,{label:"Executed",value:u.value.executed},null,8,["value"])]),e("div",$e,[l(h,{label:"Timestamp",value:D(u.value.timestamp)},null,8,["value"])]),e("div",Ne,[l(h,{label:"Error",value:u.value.error},null,8,["value"])])],4),o(a).isCommands?v("",!0):(c(),r("div",Ye,[l(h,{label:"Metadata",value:u.value.metadata},null,8,["value"])])),o(a).isCommands?v("",!0):(c(),r("div",je,[l(h,{label:"Tags",value:u.value.tags},null,8,["value"])])),o(a).isCommands?v("",!0):(c(),r("div",ze,[l(j,{label:"Body",value:u.value.body,styleProp:"height: 32vh"},null,8,["value"])]))])):v("",!0)],64)}}}),os=ue(He,[["__scopeId","data-v-f03fa843"]]);export{os as default};
