import N from"./InputText.63c92f00.js";import{c as F,d as W}from"./stream.38699bf4.js";import{a as A,s as i,M as E,S as L,Q as R,o as c,f as g,h as s,i as d,c as C,q as k,w as y,R as j,t as S,l as q,r as p,k as H}from"./entry.53b34a98.js";import"./StatStripCard.vue_vue_type_style_index_0_scoped_b87ef05f_lang.52c9345e.js";const O={class:"grid-nogutter grid p-0"},Q={class:"flex align-items-end col-12 md:12 align-content-between mb-1 pt-0 border-bottom-1 border-light-grey"},U={class:"flex flex-grow-1 align-items-end p-0"},G={class:"align-items-end grid p-fluid col-6 pb-0 mb-1"},J={class:"col-12 md:col-4 pt-0"},K={class:"col-12 md:col-4"},P={class:"ml-1"},X={key:0,class:"col-12 md:col-4 pt-0"},Y={class:"mb-3"},Z={class:"flex justify-content-end",style:{"min-width":"10rem"}},ee={key:0,class:"col-12 md:12 pt-1"},te={class:"text-sm"},se=A({__name:"Monitor",props:{type:{type:String,default:()=>""},channel:{type:String,default:""}},setup(w){const b=w,{ApiBaseHost:B}=F(),l=i([]),r=i([]),m=i(""),v=i(null);let n=E({});const t=i(!1),a=()=>{v.value&&v.value.scrollToBottom()};L(()=>{a()}),R(()=>{t.value&&h()});const _=u=>{l.value.push({id:l.value.length,message:u}),m.value.length>0?r.value=l.value.filter(e=>e.message.toLowerCase().includes(m.value.toLowerCase())):r.value=l.value,a()},D=()=>{n=W(`ws://${B.value}/api/monitor?channel=${b.channel}&kind=${b.type}`,{autoClose:!1,immediate:!1,onConnected:()=>{t.value=!0,a()},onDisconnected:()=>{t.value=!1,_("Disconnected")},onError:(u,e)=>{t.value=!1,_(e.type)},onMessage:(u,e)=>{t.value=!0,_(e.data)}}),n.open(),n.send("start"),x()},h=()=>{n&&n.close()},x=()=>{l.value=[],r.value=[],a()};return(u,e)=>{const V=N,f=p("Button"),$=p("Tag"),M=p("DynamicScrollerItem"),T=p("DynamicScroller");return c(),g("div",O,[s("div",Q,[s("div",U,[s("div",G,[s("div",J,[d(V,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),label:"Filter Messages",disabled:t.value,placeholder:"No Filter"},null,8,["modelValue","disabled"])]),s("div",K,[s("div",P,[t.value?(c(),C(f,{key:1,label:"Stop",onClick:e[2]||(e[2]=o=>h()),icon:"pi pi-stop",class:"button-grey",disabled:!t.value},null,8,["disabled"])):(c(),C(f,{key:0,label:"Watch",class:"button-grey",icon:"pi pi-eye",onClick:e[1]||(e[1]=o=>D()),style:{"min-width":"5rem"}}))])]),t.value?(c(),g("div",X,[s("div",null,[d(f,{label:"Clear",class:"button-grey",icon:"pi pi-trash",onClick:e[3]||(e[3]=o=>x()),style:{"min-width":"10rem"}})])])):k("",!0)])]),s("div",Y,[s("div",Z,[d($,{class:q(["text-sm border-round-xl font-italic font-light mr-1",t.value?"bg-success":"bg-error"])},{default:y(()=>[j(S(t.value?"Watching":"Disconnected"),1)]),_:1},8,["class"])])])]),t.value?(c(),g("div",ee,[s("div",null,[s("div",null,[d(T,{items:r.value,"min-item-size":16,class:"scroller",ref_key:"dynamicScroller",ref:v,onResize:e[4]||(e[4]=o=>a())},{default:y(({item:o,index:z,active:I})=>[d(M,{item:o,active:I,"size-dependencies":[o.message],"data-index":z,class:"ml-2"},{default:y(()=>[s("pre",te,S(o.message),1)]),_:2},1032,["item","active","size-dependencies","data-index"])]),_:1},8,["items"])])])])):k("",!0)])}}}),ie=H(se,[["__scopeId","data-v-8e6cb807"]]);export{ie as default};
