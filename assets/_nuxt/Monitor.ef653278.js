import F from"./InputText.dcc834c4.js";import{c as W,d as A}from"./stream.7512440b.js";import{a as E,s as i,M as L,S as R,Q as j,o as c,f as g,h as s,i as d,c as k,q as C,w as b,R as q,t as S,l as H,r as p,k as O}from"./entry.e4fef673.js";import"./StatStripCard.vue_vue_type_style_index_0_scoped_b87ef05f_lang.90af4798.js";const Q={class:"grid-nogutter grid p-0"},U={class:"flex align-items-end col-12 md:12 align-content-between mb-1 pt-0 border-bottom-1 border-light-grey"},G={class:"flex flex-grow-1 align-items-end p-0"},J={class:"align-items-end grid p-fluid col-6 pb-0 mb-1"},K={class:"col-12 md:col-4 pt-0"},P={class:"col-12 md:col-4"},X={class:"ml-1"},Y={key:0,class:"col-12 md:col-4 pt-0"},Z={class:"mb-3"},ee={class:"flex justify-content-end",style:{"min-width":"10rem"}},te={key:0,class:"col-12 md:12 pt-1"},se={class:"text-sm"},oe=E({__name:"Monitor",props:{type:{type:String,default:()=>""},channel:{type:String,default:""}},setup(w){const y=w,{ApiBaseHost:B,BaseWebSocket:D}=W(),l=i([]),r=i([]),m=i(""),v=i(null);let n=L({});const t=i(!1),a=()=>{v.value&&v.value.scrollToBottom()};R(()=>{a()}),j(()=>{t.value&&h()});const _=u=>{l.value.push({id:l.value.length,message:u}),m.value.length>0?r.value=l.value.filter(e=>e.message.toLowerCase().includes(m.value.toLowerCase())):r.value=l.value,a()},$=()=>{n=A(`${D.value}${B.value}/api/monitor?channel=${y.channel}&kind=${y.type}`,{autoClose:!1,immediate:!1,onConnected:()=>{t.value=!0,a()},onDisconnected:()=>{t.value=!1,_("Disconnected")},onError:(u,e)=>{t.value=!1,_(e.type)},onMessage:(u,e)=>{t.value=!0,_(e.data)}}),n.open(),n.send("start"),x()},h=()=>{n&&n.close()},x=()=>{l.value=[],r.value=[],a()};return(u,e)=>{const V=F,f=p("Button"),M=p("Tag"),T=p("DynamicScrollerItem"),z=p("DynamicScroller");return c(),g("div",Q,[s("div",U,[s("div",G,[s("div",J,[s("div",K,[d(V,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),label:"Filter Messages",disabled:t.value,placeholder:"No Filter"},null,8,["modelValue","disabled"])]),s("div",P,[s("div",X,[t.value?(c(),k(f,{key:1,label:"Stop",onClick:e[2]||(e[2]=o=>h()),icon:"pi pi-stop",class:"button-grey",disabled:!t.value},null,8,["disabled"])):(c(),k(f,{key:0,label:"Watch",class:"button-grey",icon:"pi pi-eye",onClick:e[1]||(e[1]=o=>$()),style:{"min-width":"5rem"}}))])]),t.value?(c(),g("div",Y,[s("div",null,[d(f,{label:"Clear",class:"button-grey",icon:"pi pi-trash",onClick:e[3]||(e[3]=o=>x()),style:{"min-width":"10rem"}})])])):C("",!0)])]),s("div",Z,[s("div",ee,[d(M,{class:H(["text-sm border-round-xl font-italic font-light mr-1",t.value?"bg-success":"bg-error"])},{default:b(()=>[q(S(t.value?"Watching":"Disconnected"),1)]),_:1},8,["class"])])])]),t.value?(c(),g("div",te,[s("div",null,[s("div",null,[d(z,{items:r.value,"min-item-size":16,class:"scroller",ref_key:"dynamicScroller",ref:v,onResize:e[4]||(e[4]=o=>a())},{default:b(({item:o,index:I,active:N})=>[d(T,{item:o,active:N,"size-dependencies":[o.message],"data-index":I,class:"ml-2"},{default:b(()=>[s("pre",se,S(o.message),1)]),_:2},1032,["item","active","size-dependencies","data-index"])]),_:1},8,["items"])])])])):C("",!0)])}}}),ce=O(oe,[["__scopeId","data-v-50eaebdf"]]);export{ce as default};
