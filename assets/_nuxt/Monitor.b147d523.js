import O from"./InputText.a5d51f5e.js";import{e as R,c as j,d as q}from"./stream.cbe555aa.js";import{u as H}from"./useToastMessage.47adc00c.js";import{a as J,s as d,L as P,R as Q,P as U,o as i,f as y,h as o,i as p,c as h,q as b,w as C,Q as G,t as $,l as K,r as _,k as X}from"./entry.7307fc4c.js";import"./StatStripCard.vue_vue_type_style_index_0_scoped_b87ef05f_lang.ef632115.js";import"./composables.0bc75d07.js";const Y={class:"grid-nogutter grid p-0"},Z={class:"flex align-items-end col-12 md:12 align-content-between mb-1 pt-0 border-bottom-1 border-light-grey"},ee={class:"flex flex-grow-1 align-items-end p-0"},oe={class:"align-items-end grid p-fluid col-8 pb-0 mb-1"},se={class:"col-12 md:col-3 pt-0"},te={class:"col-12 md:col-3"},le={class:"ml-1"},ne={class:"col-12 md:col-3"},ae={class:"ml-1"},ie={key:0,class:"col-12 md:col-3 pt-0"},ce={class:"mb-3"},re={class:"flex justify-content-end",style:{"min-width":"10rem"}},de={key:0,class:"col-12 md:12 pt-1"},pe={class:"item mr-2"},ue=["onClick"],me=J({__name:"Monitor",props:{type:{type:String,default:()=>""},channel:{type:String,default:""}},setup(D){const w=D,{isSupported:k,copy:x}=R(),l=H(),{ApiBaseHost:M,BaseWebSocket:T}=j(),n=d([]),u=d([]),m=d(""),f=d(null);let c=P({});const s=d(!1),r=()=>{f.value&&f.value.scrollToBottom()};Q(()=>{r()}),U(()=>{s.value&&S()});const g=a=>{n.value.push({id:n.value.length,message:a}),m.value.length>0?u.value=n.value.filter(e=>e.message.toLowerCase().includes(m.value.toLowerCase())):u.value=n.value,r()},E=()=>{c=q(`${T.value}${M.value}/api/monitor?channel=${w.channel}&kind=${w.type}`,{autoClose:!1,immediate:!1,onConnected:()=>{s.value=!0,r()},onDisconnected:()=>{s.value=!1,g("Disconnected")},onError:(a,e)=>{s.value=!1,g(e.type)},onMessage:(a,e)=>{s.value=!0,g(e.data)}}),c.open(),c.send("start"),B()},S=()=>{c&&c.close()},B=()=>{n.value=[],u.value=[],r()},N=a=>{k?x(a).then(()=>{l.showSuccess("Message copied to clipboard")}).catch(()=>{l.showError("Failed to copy message to clipboard")}):l.showError("Copy to clipboard is not supported")},V=()=>{if(n.value.length===0){l.showError("No messages to copy");return}k?x(JSON.stringify(n.value,null,2)).then(()=>{l.showSuccess("Messages copied to clipboard")}).catch(()=>{l.showError("Failed to copy messages to clipboard")}):l.showError("Copy to clipboard is not supported")};return(a,e)=>{const F=O,v=_("Button"),z=_("Tag"),I=_("DynamicScrollerItem"),W=_("DynamicScroller");return i(),y("div",Y,[o("div",Z,[o("div",ee,[o("div",oe,[o("div",se,[p(F,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),label:"Filter Messages",disabled:s.value,placeholder:"No Filter"},null,8,["modelValue","disabled"])]),o("div",te,[o("div",le,[s.value?(i(),h(v,{key:1,label:"Stop",onClick:e[2]||(e[2]=t=>S()),icon:"pi pi-stop",class:"button-grey",disabled:!s.value},null,8,["disabled"])):(i(),h(v,{key:0,label:"Watch",class:"button-grey",icon:"pi pi-eye",onClick:e[1]||(e[1]=t=>E()),style:{"min-width":"5rem"}}))])]),o("div",ne,[o("div",ae,[s.value?(i(),h(v,{key:0,label:"Copy",onClick:e[3]||(e[3]=t=>V()),icon:"pi pi-copy",class:"button-grey"})):b("",!0)])]),s.value?(i(),y("div",ie,[o("div",null,[p(v,{label:"Clear",class:"button-grey",icon:"pi pi-trash",onClick:e[4]||(e[4]=t=>B()),style:{"min-width":"10rem"}})])])):b("",!0)])]),o("div",ce,[o("div",re,[p(z,{class:K(["text-sm border-round-xl font-italic font-light mr-1",s.value?"bg-success":"bg-error"])},{default:C(()=>[G($(s.value?"Watching":"Disconnected"),1)]),_:1},8,["class"])])])]),s.value?(i(),y("div",de,[o("div",null,[o("div",null,[p(W,{items:u.value,"min-item-size":16,class:"scroller",ref_key:"dynamicScroller",ref:f,onResize:e[5]||(e[5]=t=>r())},{default:C(({item:t,index:L,active:A})=>[p(I,{item:t,active:A,"size-dependencies":[t.message],"data-index":L,class:"ml-2"},{default:C(()=>[o("div",pe,[o("pre",{class:"text-sm cursor-pointer overflow-hidden text-overflow-ellipsis",onClick:ve=>N(t.message)},$(t.message),9,ue)])]),_:2},1032,["item","active","size-dependencies","data-index"])]),_:1},8,["items"])])])])):b("",!0)])}}}),Ce=X(me,[["__scopeId","data-v-1304ffd4"]]);export{Ce as default};
